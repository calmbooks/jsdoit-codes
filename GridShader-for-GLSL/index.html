<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>GridShader for GLSL - js do it</title>
<meta name="Description" content="" />
<meta name="Keywords"  content="" />

<link rel="stylesheet" type="text/css" media="screen,print" href="style.css" />
</head>
<body>
<!-- generated by: jsdo.it - http://jsdo.it/calmbooks/GridShader -->
<!-- Copyright calmbooks - http://jsdo.it/calmbooks -->
<!-- Licensed under MIT License - http://www.opensource.org/licenses/mit-license.php -->
<script id="vertexShader" type="x-shader/x-vertex">

attribute vec3 position;
uniform mat4 mv_matrix;

void main( void ) {

	gl_Position = mv_matrix * vec4( position, 1.0 );
}

</script>

<script id="fragmentShader" type="x-shader/x-fragment">

precision mediump float;

uniform float time;
uniform vec2 resolution;
    
const float _GridIntervalX = 17.0;
const float _GridIntervalY = 17.0;

const int _ScaleSlidX = 5;
const int _ScaleSlidY = 5;

const vec4 _Color = vec4(1.0,0.2,0.0,0.7);

float getRatioX( float uvx, int d, float w, float k ) {

    float n1 = _GridIntervalX * float(d);
    float n2 = (n1 - 1.0) / 2.0;
    float n3 = w; // 太さ
    float n4 = n2 - n3;
    float n5 = k; // 硬さ

    return (abs(mod(uvx, n1) - n2) - n4) / n3 * n5;
}

float getRatioY( float uvy, int d, float w, float k ) {

    uvy += 5.0;

    float n1 = _GridIntervalY * float(d);
    float n2 = (n1 - 1.0) / 2.0;
    float n3 = w; // 太さ
    float n4 = n2 - n3;
    float n5 = k; // 硬さ

    return (abs(mod(uvy, n1) - n2 * sign(uvy)) - n4) / n3 * n5;
}

float getDotRatio( float uvx, float uvy ) {

    uvx += ( _GridIntervalX / 2.0);
    uvy += 5.0 + ( _GridIntervalY / 2.0);

    float xn1 = _GridIntervalX;
    float xn2 = (xn1 - 1.0) / 2.0;
    float xn3 = abs(mod(uvx, xn1) - xn2) / xn1;
    float xn4 = 1.0 - xn3;

    float yn1 = _GridIntervalY;
    float yn2 = (yn1 - 1.0) / 2.0;
    float yn3 = abs(mod(uvy, yn1) - yn2 * sign(uvy)) / yn1;
    float yn4 = 1.0 - yn3;

    float xyn1 = sqrt( pow(xn3, 2.0) + pow(yn3, 2.0) );

    return pow(1.0 - xyn1 + 0.08, 10.0);
}

void main( void ) {

    float uvx = gl_FragCoord.x;
    float uvy = gl_FragCoord.y;

    float ratioX = getRatioX(uvx, 1, 2.2, 0.5);
    float ratioY = getRatioY(uvy, 1, 2.2, 0.5);
    float ratioBoldX = getRatioX(uvx, _ScaleSlidX, 2.2, 1.0);
    float ratioBoldY = getRatioY(uvy, _ScaleSlidY, 2.2, 1.0);

    float dotRatio = getDotRatio(uvx, uvy);

    float ratioXY = max(ratioY, ratioX);
    float ratioBoldXY = max(ratioBoldX, ratioBoldY);
    float ratio = max(max(ratioXY, ratioBoldXY), dotRatio);

    float r = _Color.r * ratio * _Color.a;
    float g = _Color.g * ratio * _Color.a;
    float b = _Color.b * ratio * _Color.a;

    gl_FragColor = vec4(r,g,b,1.0);
}
    
</script>


<script type="text/javascript" src="http://jsdo.it/calmbooks/PostEffectFrame/js"></script>

<script type="text/javascript" src="index.js"></script>
</body>
</html>
